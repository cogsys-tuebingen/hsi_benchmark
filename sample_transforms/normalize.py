import torch
from camera_definitions import CameraType
from functools import cache


class Normalize(object):
    def __init__(self, dataset: str):
        self.dataset = dataset

    @cache
    def load_properties(self, camera_type: CameraType):
        if self.dataset == 'fruit':
            mean, std = load_properties_fruit(camera_type)
        elif self.dataset == 'debris':
            mean, std = load_properties_debris(camera_type)
        elif self.dataset == 'remote_sensing':
            mean, std = load_properties_hrss(camera_type)
        elif self.dataset == 'waste':
            mean, std = load_properties_waste(camera_type)
        else:
            raise Exception('Unknown data set')

        return mean, std

    @torch.no_grad()
    def __call__(self, sample):
        item, label, meta = sample

        mean, std = self.load_properties(meta.camera_type)
        item = bands_as_first_dimension((bands_as_first_dimension_rev(item) - mean) / std)

        return item, label, meta


def load_properties_debris(camera_type: CameraType):
    if camera_type == CameraType.SPECIM_FX10:
        mean = (0.1078, 0.1083, 0.1054, 0.1037, 0.1015, 0.0997, 0.0973, 0.0952, 0.0940,
                0.0932, 0.0929, 0.0928, 0.0906, 0.0905, 0.0911, 0.0915, 0.0912, 0.0916,
                0.0918, 0.0924, 0.0931, 0.0942, 0.0938, 0.0931, 0.0929, 0.0934, 0.0930,
                0.0930, 0.0928, 0.0932, 0.0931, 0.0933, 0.0936, 0.0940, 0.0945, 0.0949,
                0.0955, 0.0958, 0.0964, 0.0966, 0.0974, 0.0979, 0.0985, 0.0992, 0.0997,
                0.1002, 0.1008, 0.1014, 0.1017, 0.1025, 0.1033, 0.1041, 0.1047, 0.1055,
                0.1064, 0.1071, 0.1079, 0.1086, 0.1098, 0.1106, 0.1115, 0.1122, 0.1134,
                0.1145, 0.1156, 0.1165, 0.1175, 0.1188, 0.1201, 0.1214, 0.1223, 0.1233,
                0.1244, 0.1255, 0.1264, 0.1270, 0.1279, 0.1288, 0.1297, 0.1305, 0.1309,
                0.1312, 0.1317, 0.1321, 0.1326, 0.1329, 0.1331, 0.1336, 0.1340, 0.1343,
                0.1343, 0.1344, 0.1346, 0.1351, 0.1355, 0.1358, 0.1359, 0.1359, 0.1363,
                0.1371, 0.1378, 0.1385, 0.1388, 0.1387, 0.1386, 0.1390, 0.1395, 0.1403,
                0.1409, 0.1412, 0.1414, 0.1417, 0.1421, 0.1427, 0.1434, 0.1440, 0.1445,
                0.1449, 0.1452, 0.1455, 0.1458, 0.1461, 0.1464, 0.1467, 0.1470, 0.1473,
                0.1477, 0.1481, 0.1483, 0.1484, 0.1484, 0.1483, 0.1485, 0.1488, 0.1493,
                0.1497, 0.1501, 0.1504, 0.1506, 0.1505, 0.1504, 0.1502, 0.1502, 0.1504,
                0.1505, 0.1508, 0.1511, 0.1512, 0.1512, 0.1509, 0.1507, 0.1503, 0.1504,
                0.1505, 0.1507, 0.1509, 0.1510, 0.1509, 0.1510, 0.1510, 0.1508, 0.1505,
                0.1504, 0.1503, 0.1502, 0.1501, 0.1501, 0.1501, 0.1501, 0.1501, 0.1501,
                0.1501, 0.1500, 0.1499, 0.1497, 0.1495, 0.1493, 0.1492, 0.1489, 0.1491,
                0.1490, 0.1492, 0.1491, 0.1492, 0.1491, 0.1492, 0.1492, 0.1493, 0.1492,
                0.1492, 0.1492, 0.1494, 0.1494, 0.1493, 0.1497, 0.1498, 0.1498, 0.1501,
                0.1500, 0.1503, 0.1506, 0.1512, 0.1510, 0.1509, 0.1511, 0.1512, 0.1515,
                0.1521, 0.1524, 0.1525, 0.1529, 0.1531, 0.1537, 0.1540, 0.1541, 0.1546,
                0.1550, 0.1546, 0.1547, 0.1549, 0.1550, 0.1557, 0.1556, 0.1564)
        std = (0.0951, 0.0942, 0.0917, 0.0894, 0.0868, 0.0845, 0.0826, 0.0811, 0.0801,
               0.0797, 0.0796, 0.0799, 0.0793, 0.0795, 0.0802, 0.0808, 0.0812, 0.0817,
               0.0823, 0.0831, 0.0836, 0.0844, 0.0847, 0.0845, 0.0845, 0.0850, 0.0850,
               0.0851, 0.0853, 0.0857, 0.0858, 0.0861, 0.0864, 0.0866, 0.0870, 0.0875,
               0.0879, 0.0880, 0.0887, 0.0891, 0.0894, 0.0897, 0.0904, 0.0910, 0.0913,
               0.0916, 0.0923, 0.0929, 0.0931, 0.0936, 0.0943, 0.0950, 0.0953, 0.0958,
               0.0965, 0.0970, 0.0974, 0.0978, 0.0987, 0.0992, 0.0995, 0.0998, 0.1006,
               0.1015, 0.1020, 0.1023, 0.1027, 0.1035, 0.1045, 0.1051, 0.1055, 0.1060,
               0.1069, 0.1077, 0.1082, 0.1085, 0.1089, 0.1096, 0.1103, 0.1108, 0.1110,
               0.1112, 0.1116, 0.1120, 0.1122, 0.1124, 0.1126, 0.1129, 0.1133, 0.1134,
               0.1134, 0.1133, 0.1134, 0.1138, 0.1142, 0.1144, 0.1144, 0.1142, 0.1144,
               0.1149, 0.1155, 0.1161, 0.1163, 0.1162, 0.1160, 0.1161, 0.1164, 0.1170,
               0.1175, 0.1177, 0.1177, 0.1177, 0.1179, 0.1183, 0.1187, 0.1192, 0.1194,
               0.1196, 0.1197, 0.1199, 0.1201, 0.1202, 0.1204, 0.1206, 0.1207, 0.1209,
               0.1211, 0.1213, 0.1215, 0.1214, 0.1213, 0.1211, 0.1212, 0.1214, 0.1217,
               0.1220, 0.1223, 0.1226, 0.1227, 0.1226, 0.1225, 0.1223, 0.1222, 0.1223,
               0.1224, 0.1226, 0.1228, 0.1229, 0.1229, 0.1226, 0.1224, 0.1221, 0.1221,
               0.1222, 0.1223, 0.1225, 0.1225, 0.1225, 0.1225, 0.1224, 0.1223, 0.1220,
               0.1219, 0.1218, 0.1217, 0.1217, 0.1216, 0.1216, 0.1216, 0.1216, 0.1215,
               0.1214, 0.1213, 0.1212, 0.1210, 0.1209, 0.1207, 0.1206, 0.1204, 0.1204,
               0.1204, 0.1204, 0.1204, 0.1205, 0.1204, 0.1205, 0.1204, 0.1205, 0.1204,
               0.1203, 0.1203, 0.1204, 0.1204, 0.1204, 0.1206, 0.1207, 0.1207, 0.1209,
               0.1209, 0.1210, 0.1211, 0.1214, 0.1212, 0.1210, 0.1211, 0.1213, 0.1215,
               0.1217, 0.1219, 0.1221, 0.1223, 0.1225, 0.1228, 0.1230, 0.1231, 0.1234,
               0.1237, 0.1235, 0.1236, 0.1237, 0.1238, 0.1241, 0.1241, 0.1246)
    elif camera_type == CameraType.CORNING_HSI:
        mean = (0.0986, 0.0985, 0.0971, 0.0965, 0.0952, 0.0942, 0.0931, 0.0924, 0.0911,
                0.0901, 0.0890, 0.0878, 0.0873, 0.0871, 0.0865, 0.0860, 0.0854, 0.0854,
                0.0849, 0.0849, 0.0846, 0.0842, 0.0839, 0.0832, 0.0825, 0.0819, 0.0815,
                0.0812, 0.0809, 0.0805, 0.0805, 0.0805, 0.0805, 0.0804, 0.0803, 0.0797,
                0.0797, 0.0795, 0.0798, 0.0799, 0.0801, 0.0801, 0.0804, 0.0804, 0.0810,
                0.0810, 0.0813, 0.0812, 0.0816, 0.0816, 0.0821, 0.0822, 0.0827, 0.0828,
                0.0833, 0.0834, 0.0840, 0.0843, 0.0849, 0.0851, 0.0856, 0.0857, 0.0861,
                0.0863, 0.0869, 0.0873, 0.0879, 0.0883, 0.0889, 0.0894, 0.0901, 0.0907,
                0.0914, 0.0920, 0.0928, 0.0934, 0.0941, 0.0946, 0.0951, 0.0957, 0.0965,
                0.0973, 0.0980, 0.0987, 0.0994, 0.1002, 0.1010, 0.1017, 0.1024, 0.1031,
                0.1037, 0.1044, 0.1050, 0.1057, 0.1062, 0.1067, 0.1071, 0.1075, 0.1078,
                0.1081, 0.1084, 0.1088, 0.1092, 0.1095, 0.1099, 0.1102, 0.1104, 0.1106,
                0.1109, 0.1112, 0.1115, 0.1117, 0.1119, 0.1121, 0.1123, 0.1125, 0.1128,
                0.1131, 0.1133, 0.1135, 0.1136, 0.1137, 0.1137, 0.1139, 0.1140, 0.1143,
                0.1144, 0.1145, 0.1146, 0.1148, 0.1149, 0.1151, 0.1153, 0.1154, 0.1155,
                0.1157, 0.1158, 0.1159, 0.1161, 0.1163, 0.1165, 0.1167, 0.1169, 0.1171,
                0.1174, 0.1177, 0.1179, 0.1180, 0.1181, 0.1181, 0.1183, 0.1185, 0.1187,
                0.1188, 0.1189, 0.1190, 0.1191, 0.1193, 0.1195, 0.1196, 0.1197, 0.1199,
                0.1199, 0.1200, 0.1200, 0.1201, 0.1200, 0.1199, 0.1198, 0.1199, 0.1198,
                0.1199, 0.1199, 0.1201, 0.1203, 0.1207, 0.1209, 0.1215, 0.1216, 0.1222,
                0.1224, 0.1230, 0.1230, 0.1233, 0.1231, 0.1234, 0.1231, 0.1232, 0.1229,
                0.1229, 0.1225, 0.1226, 0.1223, 0.1224, 0.1222, 0.1224, 0.1223, 0.1225,
                0.1224, 0.1226, 0.1225, 0.1227, 0.1224, 0.1225, 0.1222, 0.1224, 0.1222,
                0.1225, 0.1226, 0.1229, 0.1228, 0.1230, 0.1229, 0.1231, 0.1230, 0.1232,
                0.1231, 0.1232, 0.1233, 0.1234, 0.1231, 0.1232, 0.1232, 0.1233, 0.1234,
                0.1234, 0.1229, 0.1229, 0.1229, 0.1229, 0.1227, 0.1226, 0.1223, 0.1223,
                0.1225, 0.1224, 0.1225, 0.1223, 0.1219, 0.1217, 0.1218, 0.1216, 0.1216,
                0.1214, 0.1214, 0.1213, 0.1211, 0.1206, 0.1207)
        std = (0.0825, 0.0823, 0.0814, 0.0815, 0.0807, 0.0806, 0.0800, 0.0801, 0.0795,
               0.0793, 0.0788, 0.0786, 0.0785, 0.0790, 0.0789, 0.0790, 0.0789, 0.0792,
               0.0792, 0.0795, 0.0797, 0.0799, 0.0800, 0.0798, 0.0794, 0.0791, 0.0790,
               0.0789, 0.0789, 0.0787, 0.0789, 0.0789, 0.0792, 0.0792, 0.0794, 0.0791,
               0.0792, 0.0791, 0.0794, 0.0794, 0.0797, 0.0797, 0.0801, 0.0802, 0.0808,
               0.0809, 0.0812, 0.0811, 0.0814, 0.0815, 0.0820, 0.0821, 0.0825, 0.0826,
               0.0830, 0.0832, 0.0837, 0.0839, 0.0844, 0.0846, 0.0850, 0.0851, 0.0854,
               0.0855, 0.0859, 0.0862, 0.0867, 0.0870, 0.0874, 0.0877, 0.0882, 0.0886,
               0.0890, 0.0894, 0.0899, 0.0904, 0.0907, 0.0910, 0.0912, 0.0915, 0.0918,
               0.0923, 0.0927, 0.0931, 0.0935, 0.0940, 0.0943, 0.0948, 0.0951, 0.0956,
               0.0959, 0.0964, 0.0967, 0.0972, 0.0975, 0.0978, 0.0981, 0.0983, 0.0985,
               0.0987, 0.0989, 0.0992, 0.0994, 0.0997, 0.0999, 0.1002, 0.1003, 0.1005,
               0.1007, 0.1009, 0.1011, 0.1013, 0.1014, 0.1016, 0.1017, 0.1019, 0.1021,
               0.1023, 0.1025, 0.1026, 0.1027, 0.1027, 0.1027, 0.1028, 0.1029, 0.1030,
               0.1031, 0.1031, 0.1032, 0.1032, 0.1033, 0.1034, 0.1034, 0.1034, 0.1035,
               0.1035, 0.1036, 0.1036, 0.1037, 0.1038, 0.1039, 0.1039, 0.1041, 0.1042,
               0.1044, 0.1045, 0.1046, 0.1046, 0.1045, 0.1044, 0.1045, 0.1046, 0.1047,
               0.1047, 0.1047, 0.1047, 0.1048, 0.1048, 0.1049, 0.1050, 0.1050, 0.1050,
               0.1050, 0.1050, 0.1050, 0.1049, 0.1048, 0.1047, 0.1045, 0.1044, 0.1043,
               0.1043, 0.1042, 0.1044, 0.1044, 0.1047, 0.1049, 0.1052, 0.1054, 0.1058,
               0.1059, 0.1063, 0.1063, 0.1065, 0.1063, 0.1064, 0.1062, 0.1062, 0.1059,
               0.1058, 0.1055, 0.1054, 0.1051, 0.1052, 0.1049, 0.1051, 0.1048, 0.1050,
               0.1048, 0.1050, 0.1047, 0.1049, 0.1046, 0.1046, 0.1043, 0.1045, 0.1042,
               0.1044, 0.1043, 0.1044, 0.1043, 0.1044, 0.1042, 0.1043, 0.1041, 0.1042,
               0.1041, 0.1041, 0.1040, 0.1040, 0.1037, 0.1037, 0.1036, 0.1036, 0.1035,
               0.1034, 0.1030, 0.1030, 0.1028, 0.1028, 0.1025, 0.1023, 0.1020, 0.1018,
               0.1017, 0.1016, 0.1014, 0.1012, 0.1008, 0.1005, 0.1003, 0.1000, 0.0998,
               0.0994, 0.0993, 0.0991, 0.0987, 0.0980, 0.0979)
    else:
        raise Exception('Camera type {} unknown for the debris dataset.'.format(camera_type.value))

    mean, std = torch.tensor(mean), torch.tensor(std)

    return mean, std


def load_properties_fruit(camera_type: CameraType):
    if camera_type == CameraType.SPECIM_FX10:
        mean = (0.1439107, 0.13478263, 0.12440769, 0.11241852, 0.0943732, 0.07874641, 0.06818538, 0.06124336,
                0.05603915, 0.05279108, 0.04999537, 0.04734708, 0.04518094, 0.04347549, 0.04213339, 0.0410415,
                0.03953477, 0.03900715, 0.03852696, 0.03787222, 0.03775589, 0.03752484, 0.03698579, 0.03671771,
                0.03680823, 0.03638816, 0.03603073, 0.03600009, 0.03559073, 0.03550156, 0.03546725, 0.035407,
                0.0353406, 0.03557113, 0.03557836, 0.03562215, 0.03613619, 0.03635718, 0.03647538, 0.03660741,
                0.03722164, 0.03778697, 0.03831027, 0.03897315, 0.039925, 0.04091639, 0.04189028, 0.04300319,
                0.04439855, 0.04563998, 0.04683537, 0.04807685, 0.04938304, 0.05052847, 0.05167951, 0.05279118,
                0.05406684, 0.0549516, 0.05630059, 0.05735539, 0.05844218, 0.05918364, 0.05998354, 0.06059425,
                0.06120212, 0.06169931, 0.06197915, 0.06231088, 0.0628364, 0.06348951, 0.06397449, 0.064496,
                0.06534923, 0.06611504, 0.06681708, 0.06753126, 0.06841877, 0.06936134, 0.07032334, 0.071055,
                0.07152555, 0.07203841, 0.07244801, 0.07278782, 0.07331116, 0.0737133, 0.07437636, 0.07539124,
                0.07627161, 0.07669222, 0.07657531, 0.07615388, 0.07556988, 0.07501725, 0.07450809, 0.07414466,
                0.07388132, 0.07377858, 0.07382603, 0.07402846, 0.07409478, 0.07461307, 0.07448551, 0.07452395,
                0.07509737, 0.07624003, 0.07810166, 0.08060005, 0.0840538, 0.08845584, 0.09424642, 0.10304777,
                0.11440734, 0.12802649, 0.14405603, 0.16060804, 0.17549109, 0.18895468, 0.20154902, 0.21455115,
                0.22758927, 0.24044931, 0.25222448, 0.26330857, 0.2737619, 0.28468261, 0.29498645, 0.30429477,
                0.31119531, 0.31700989, 0.32231556, 0.32702667, 0.33128264, 0.33504605, 0.33868779, 0.3418471,
                0.34454638, 0.34684412, 0.34877974, 0.35020751, 0.35131816, 0.35223252, 0.35356685, 0.3551426,
                0.35701965, 0.35908453, 0.36104938, 0.36277809, 0.36417549, 0.36515757, 0.36610983, 0.36706973,
                0.36838598, 0.36982353, 0.37138946, 0.37293161, 0.37410122, 0.37508334, 0.37581137, 0.37606124,
                0.37571696, 0.37508101, 0.37472739, 0.37468945, 0.37487996, 0.37544083, 0.37602178, 0.3766692,
                0.37724782, 0.37780968, 0.37832789, 0.37883218, 0.37900206, 0.3792671, 0.37929797, 0.37932522,
                0.37908869, 0.37895215, 0.37873525, 0.37871154, 0.37843742, 0.37844122, 0.37823279, 0.378063,
                0.37763298, 0.37723249, 0.37684321, 0.37632786, 0.37557693, 0.37465928, 0.3735165, 0.37241066,
                0.37143114, 0.37014067, 0.368535, 0.36623516, 0.36329699, 0.36039171, 0.35674968, 0.3531952,
                0.34903165, 0.34463782, 0.33944813, 0.33392069, 0.3280623, 0.32182035, 0.31558825, 0.30993661,
                0.30591974, 0.30348666, 0.30217676, 0.30090122, 0.30045193, 0.29910868, 0.299074, 0.29912003,
                0.29976843, 0.30025507, 0.30160078, 0.30236217, 0.30372021, 0.30472802, 0.30638097, 0.30798454)
        std = (0.44578411, 0.41160282, 0.30814338, 0.1575601, 0.11610321, 0.08716735, 0.06908663, 0.05861825,
               0.05201726, 0.04843122, 0.04548237, 0.04206826, 0.03941196, 0.03754291, 0.03568484, 0.03455643,
               0.03306863, 0.032573, 0.03187798, 0.03124346, 0.03124028, 0.03110045, 0.03078471, 0.03072628,
               0.03100962, 0.03060091, 0.03049056, 0.0306746, 0.03045434, 0.03047997, 0.03060424, 0.03070702,
               0.03075199, 0.03106798, 0.03117949, 0.03133465, 0.03166844, 0.03193057, 0.0321598, 0.03241913,
               0.03292546, 0.03345041, 0.03398373, 0.03468771, 0.03551413, 0.03648442, 0.03758316, 0.03874331,
               0.04007312, 0.0414224, 0.0427701, 0.04416822, 0.04544258, 0.04671257, 0.04802096, 0.04919299,
               0.05043594, 0.05158568, 0.05296839, 0.05410681, 0.05519506, 0.05612104, 0.05714979, 0.05804362,
               0.05875211, 0.05932984, 0.05992949, 0.06063634, 0.06143356, 0.06210203, 0.06273231, 0.06351797,
               0.06462287, 0.06563135, 0.06638601, 0.06704923, 0.0680203, 0.06916583, 0.07034758, 0.07124594,
               0.07189701, 0.07255797, 0.07331705, 0.07398389, 0.07455326, 0.07509838, 0.07599328, 0.07715347,
               0.07814734, 0.07859898, 0.07850443, 0.07837196, 0.07837517, 0.07850925, 0.07857589, 0.07842757,
               0.07819378, 0.07806142, 0.07827485, 0.07877176, 0.07924496, 0.07988927, 0.07941173, 0.0789779,
               0.07893035, 0.07950929, 0.08081405, 0.08282497, 0.08580389, 0.08943174, 0.09360913, 0.09929651,
               0.10586767, 0.11320337, 0.12214257, 0.13128879, 0.13931342, 0.1466322, 0.15370615, 0.16166547,
               0.17012922, 0.17894675, 0.18743259, 0.19586506, 0.20420789, 0.21315318, 0.22180896, 0.22975255,
               0.23587301, 0.24105662, 0.24577452, 0.25003893, 0.25368782, 0.2568423, 0.25959906, 0.26190178,
               0.26376825, 0.26510327, 0.2660598, 0.26670687, 0.26717092, 0.26762241, 0.2682864, 0.26906212,
               0.27001787, 0.27100012, 0.27192404, 0.27269757, 0.27326868, 0.27368485, 0.27403845, 0.27442535,
               0.27503963, 0.27565787, 0.27636271, 0.27705987, 0.27750439, 0.27782021, 0.27790323, 0.27775838,
               0.27721316, 0.27657319, 0.27604701, 0.27577515, 0.27566709, 0.27574814, 0.27586137, 0.27604367,
               0.27621184, 0.27635689, 0.27644446, 0.27648072, 0.27638264, 0.27633538, 0.27617529, 0.27598816,
               0.27566096, 0.27539805, 0.27516831, 0.27493655, 0.27470455, 0.2744521, 0.27428266, 0.27396322,
               0.27359492, 0.27321773, 0.27295004, 0.2724161, 0.27183511, 0.27106195, 0.27018588, 0.26929011,
               0.26862063, 0.26778223, 0.26668069, 0.26508305, 0.26311291, 0.26107154, 0.25876359, 0.25632957,
               0.25349044, 0.25034788, 0.24668542, 0.24277168, 0.23858839, 0.23424011, 0.22971534, 0.2254785,
               0.22255782, 0.22088717, 0.21989643, 0.2189055, 0.21845635, 0.21760173, 0.21764609, 0.21768336,
               0.21832181, 0.21888741, 0.21982846, 0.22063074, 0.22198328, 0.22279717, 0.2243693, 0.22601623)
    elif camera_type == CameraType.CORNING_HSI:
        mean = (0.06838603, 0.06835698, 0.06547943, 0.06464774, 0.0621814, 0.06100412, 0.05843148, 0.05776354,
                0.05559409, 0.05434348, 0.05235799, 0.05196604, 0.05013736, 0.04915785, 0.04730979, 0.04620491,
                0.04444155, 0.04357191, 0.04200927, 0.04137537, 0.03999237, 0.03929703, 0.0380577, 0.03732534,
                0.03626833, 0.03563496, 0.03478429, 0.03443799, 0.03372892, 0.03336302, 0.03272394, 0.03237143,
                0.03173579, 0.03135904, 0.0308071, 0.03050453, 0.03005506, 0.02985415, 0.02949725, 0.02925191,
                0.02900555, 0.02891061, 0.02881162, 0.02876708, 0.02874296, 0.02872899, 0.02880945, 0.02892649,
                0.0291787, 0.02951349, 0.03000008, 0.03047266, 0.03111885, 0.03173392, 0.03257446, 0.03338983,
                0.03448683, 0.03553536, 0.03683097, 0.0380256, 0.0394503, 0.04078326, 0.04240794, 0.04395115,
                0.04586737, 0.047749, 0.05007074, 0.05235635, 0.05519456, 0.05800117, 0.06126877, 0.06440579,
                0.0678071, 0.07086302, 0.07403665, 0.07679299, 0.07965564, 0.08217394, 0.08486255, 0.08716549,
                0.08965218, 0.09198128, 0.09446671, 0.0965891, 0.09877124, 0.10071515, 0.10274589, 0.10465214,
                0.10666648, 0.10849543, 0.11035043, 0.11204441, 0.11387138, 0.11567197, 0.11752582, 0.11928472,
                0.12099575, 0.12254273, 0.12396916, 0.1252231, 0.12630446, 0.12716014, 0.12783787, 0.12843642,
                0.12900771, 0.12957831, 0.13016026, 0.13084605, 0.1315729, 0.13237664, 0.13320522, 0.13408667,
                0.13493667, 0.13571095, 0.13621611, 0.1364508, 0.13636457, 0.13605472, 0.135576, 0.13499969,
                0.13440146, 0.13391307, 0.13348855, 0.13302248, 0.13232046, 0.13131281, 0.12994801, 0.12829092,
                0.12645239, 0.12466649, 0.12310495, 0.12193587, 0.1212892, 0.12119005, 0.12161861, 0.12260909,
                0.12425528, 0.12672204, 0.13033198, 0.13526285, 0.14158968, 0.14919207, 0.15787387, 0.16745684,
                0.17774252, 0.18826691, 0.19887073, 0.20935719, 0.21949627, 0.22908721, 0.2383469, 0.24693066,
                0.25509826, 0.26320118, 0.27081545, 0.27779594, 0.28461394, 0.29124482, 0.29727173, 0.30270916,
                0.30754774, 0.31202631, 0.31593323, 0.31961746, 0.32270258, 0.32573277, 0.32816223, 0.33059366,
                0.33238806, 0.33438469, 0.3356452, 0.33713244, 0.33781645, 0.33886042, 0.33900715, 0.33945429,
                0.33909203, 0.3396786, 0.34000663, 0.3413595, 0.34201193, 0.34333689, 0.34380929, 0.34503577,
                0.34540598, 0.3465441, 0.34683773, 0.34801225, 0.34829699, 0.34934436, 0.3494487, 0.35042633,
                0.35046516, 0.35130278, 0.3512332, 0.35192562, 0.35177259, 0.35230448, 0.35193549, 0.35232362,
                0.35195691, 0.35208284, 0.35125542, 0.35106933, 0.35020817, 0.35003668, 0.34909452, 0.34867487,
                0.34730791, 0.34646601, 0.34463725, 0.34342473, 0.34163284, 0.34068379, 0.33932558, 0.33879967,
                0.33757811, 0.33710801, 0.33616585, 0.33576755, 0.33471404, 0.33428815, 0.33319638, 0.33272603,
                0.33174683, 0.33133503, 0.33032859, 0.32974955, 0.32862837, 0.32801892, 0.32672405, 0.32601954,
                0.32476332, 0.32376767, 0.32198211, 0.32080173, 0.31905655, 0.31758296, 0.31552785, 0.31366364,
                0.31150994, 0.30928221, 0.30652486, 0.30370687, 0.3006934, 0.29757202, 0.29476356, 0.29110667,
                0.28877313)
        std = (0.05080195, 0.05077147, 0.04844741, 0.04798383, 0.04613521, 0.04566919, 0.04379305, 0.04335734,
               0.04174695, 0.0412675, 0.03982402, 0.03955778, 0.03827131, 0.03777658, 0.03642197, 0.03589978,
               0.03466791, 0.0342586, 0.03317148, 0.03283927, 0.0319029, 0.03154745, 0.0307382, 0.03041327,
               0.02974826, 0.02950661, 0.02898198, 0.0288567, 0.02843828, 0.02830635, 0.02793398, 0.02782748,
               0.02745372, 0.02731883, 0.02701556, 0.02691796, 0.02667501, 0.02662027, 0.02645687, 0.02640668,
               0.02631986, 0.02630864, 0.0263097, 0.02632502, 0.02640179, 0.02646039, 0.02663168, 0.02676883,
               0.02706612, 0.02734339, 0.02782961, 0.02825251, 0.02892684, 0.02952102, 0.0304135, 0.03121175,
               0.03233049, 0.03330739, 0.03458992, 0.03568627, 0.03704691, 0.0381927, 0.03961807, 0.04086447,
               0.04245705, 0.04394905, 0.04589395, 0.04782307, 0.05029083, 0.05280157, 0.0558198, 0.05880272,
               0.06208522, 0.06511663, 0.06826104, 0.07109036, 0.0740126, 0.07672129, 0.07959893, 0.08224496,
               0.0850593, 0.08787537, 0.09080255, 0.09342575, 0.0959562, 0.09831813, 0.10057304, 0.10275691,
               0.10492132, 0.10700481, 0.10899314, 0.11090359, 0.11277459, 0.11470588, 0.11654101, 0.11838768,
               0.12009138, 0.12179331, 0.12335051, 0.12496317, 0.1263906, 0.12781711, 0.12902649, 0.13033507,
               0.13152182, 0.13279748, 0.13391676, 0.13518683, 0.13628304, 0.13744655, 0.13848122, 0.13966255,
               0.14076358, 0.14202107, 0.14315748, 0.14443403, 0.14565494, 0.14701855, 0.14831118, 0.1495719,
               0.15056287, 0.15145317, 0.15206225, 0.15246874, 0.15256806, 0.15255865, 0.15231085, 0.15184647,
               0.15110867, 0.15036845, 0.14965343, 0.14910156, 0.14885875, 0.14895772, 0.14935402, 0.15002943,
               0.15098197, 0.15224392, 0.15395183, 0.1559855, 0.15825491, 0.16041952, 0.16237539, 0.16401548,
               0.16562383, 0.16722669, 0.1691805, 0.171463, 0.17419618, 0.17711471, 0.18044819, 0.18381722,
               0.18744525, 0.19139088, 0.19550392, 0.1994563, 0.20361829, 0.20778719, 0.21187494, 0.21562208,
               0.21916832, 0.22242819, 0.22544115, 0.22820302, 0.23071885, 0.23309454, 0.23514215, 0.23701496,
               0.23854019, 0.24003699, 0.2411595, 0.24224337, 0.24290773, 0.24364663, 0.24393584, 0.24437531,
               0.24454984, 0.24512631, 0.24542164, 0.24609788, 0.24643534, 0.24713637, 0.24746683, 0.24818454,
               0.24847023, 0.24910694, 0.24933054, 0.24997692, 0.25015287, 0.25072095, 0.25082724, 0.2513642,
               0.25141897, 0.25184642, 0.25179017, 0.25210072, 0.25197507, 0.25217387, 0.25189752, 0.25199535,
               0.25171039, 0.25165221, 0.25113445, 0.2509269, 0.25030503, 0.2500013, 0.24928304, 0.24879582,
               0.24774744, 0.24695908, 0.24560458, 0.24461453, 0.24330385, 0.24248333, 0.2414832, 0.24099335,
               0.24010807, 0.23963521, 0.23884788, 0.23841193, 0.23762563, 0.23725256, 0.23645449, 0.23601489,
               0.23524844, 0.23483277, 0.23397378, 0.23349027, 0.23257222, 0.23207363, 0.23100105, 0.23039842,
               0.22928303, 0.2285327, 0.22709815, 0.22621119, 0.22464282, 0.22355499, 0.22180693, 0.22045292,
               0.21854487, 0.21692845, 0.21463658, 0.21270225, 0.21020956, 0.20798238, 0.20543637, 0.20271051,
               0.20062932)
    elif camera_type == CameraType.INNOSPEC_REDEYE:
        mean = (0.25246843695640564, 0.20367072522640228, 0.23449595272541046, 0.26059335470199585,
                0.2527230978012085, 0.25772014260292053, 0.26779550313949585, 0.29485949873924255,
                0.3150586187839508, 0.3822185695171356, 0.3507082462310791, 0.372749924659729,
                0.36660832166671753, 0.36228692531585693, 0.3569612205028534, 0.3600204586982727,
                0.3595893085002899, 0.35958319902420044, 0.3600192666053772, 0.3607463538646698,
                0.362000435590744, 0.36355602741241455, 0.3655463457107544, 0.3676984906196594,
                0.37012016773223877, 0.37257713079452515, 0.375250905752182, 0.37807130813598633,
                0.3811369836330414, 0.38396868109703064, 0.38704073429107666, 0.3900705575942993,
                0.3930838406085968, 0.39610666036605835, 0.3992055356502533, 0.40202733874320984,
                0.4046315550804138, 0.4072176218032837, 0.4095773696899414, 0.4117245674133301,
                0.4136631488800049, 0.4151330292224884, 0.41658759117126465, 0.41779041290283203,
                0.41838014125823975, 0.41875284910202026, 0.4188230335712433, 0.41859015822410583,
                0.4180617332458496, 0.4172356426715851, 0.4161553382873535, 0.4147394895553589,
                0.41313475370407104, 0.41130056977272034, 0.40918004512786865, 0.4067307710647583,
                0.4041423499584198, 0.40113580226898193, 0.3978062868118286, 0.3940078914165497,
                0.38986527919769287, 0.3853277862071991, 0.38027018308639526, 0.37458065152168274,
                0.3681028187274933, 0.3606296479701996, 0.35220423340797424, 0.3428560793399811,
                0.333614706993103, 0.3248330354690552, 0.31731176376342773, 0.3109995722770691,
                0.3063927888870239, 0.3029343783855438, 0.3004623353481293, 0.29856783151626587,
                0.2972108721733093, 0.2960720956325531, 0.2952919900417328, 0.2944614887237549,
                0.2938000559806824, 0.2930529713630676, 0.292439728975296, 0.2917446792125702,
                0.2913435995578766, 0.2911834120750427, 0.29133525490760803, 0.2914484441280365,
                0.29188111424446106, 0.2923249900341034, 0.2929506301879883, 0.29365548491477966,
                0.2944844365119934, 0.2953532040119171, 0.29632583260536194, 0.29722246527671814,
                0.29813656210899353, 0.2989230751991272, 0.2996326982975006, 0.30027052760124207,
                0.3009365200996399, 0.30149033665657043, 0.30194801092147827, 0.30216631293296814,
                0.30250978469848633, 0.30250808596611023, 0.3023666739463806, 0.3021002411842346,
                0.30163028836250305, 0.30091533064842224, 0.30008983612060547, 0.2987985610961914,
                0.2974887490272522, 0.2957976758480072, 0.29384657740592957, 0.2915194034576416,
                0.28904247283935547, 0.2860560119152069, 0.2830025255680084, 0.2796124219894409,
                0.27587583661079407, 0.27190372347831726, 0.2677280604839325, 0.26325923204421997,
                0.2587939202785492, 0.25427353382110596, 0.2497767060995102, 0.24523712694644928,
                0.24089576303958893, 0.2367335706949234, 0.23277311027050018, 0.22887329757213593,
                0.22529630362987518, 0.22178077697753906, 0.21826326847076416, 0.21459835767745972,
                0.2107025533914566, 0.20629632472991943, 0.20131945610046387, 0.1957404464483261,
                0.18964596092700958, 0.1830458641052246, 0.1758243292570114, 0.16777285933494568,
                0.15948672592639923, 0.151448056101799, 0.14416171610355377, 0.13729742169380188,
                0.13145147264003754, 0.12663030624389648, 0.12270348519086838, 0.11958488821983337,
                0.11709846556186676, 0.11498712003231049, 0.11331142485141754, 0.11196156591176987,
                0.11086834967136383, 0.10992196202278137, 0.1091114804148674, 0.10850206762552261,
                0.1081385388970375, 0.10771704465150833, 0.10744945704936981, 0.10740197449922562,
                0.10733875632286072, 0.10724395513534546, 0.10732632875442505, 0.10743610560894012,
                0.10770045965909958, 0.10794396698474884, 0.10845556855201721, 0.10899580270051956,
                0.1096629872918129, 0.11040083318948746, 0.11121552437543869, 0.11209578067064285,
                0.11301722377538681, 0.11390651762485504, 0.11495991051197052, 0.11599672585725784,
                0.11716532707214355, 0.11831463873386383, 0.11956706643104553, 0.12062894552946091,
                0.1219468042254448, 0.12316345423460007, 0.12447096407413483, 0.12567971646785736,
                0.1269966959953308, 0.1283010095357895, 0.1296614408493042, 0.1309259980916977,
                0.13236230611801147, 0.1334831565618515, 0.13474911451339722, 0.13603812456130981,
                0.13735899329185486, 0.13870784640312195, 0.13999563455581665, 0.14104622602462769,
                0.14240258932113647, 0.14355836808681488, 0.14484921097755432, 0.14595435559749603,
                0.14712123572826385, 0.1481814980506897, 0.14934368431568146, 0.15033210813999176,
                0.15149466693401337, 0.15248599648475647, 0.15365615487098694, 0.1545674353837967,
                0.1556553840637207, 0.15650126338005066, 0.15745487809181213, 0.15829703211784363,
                0.159190833568573, 0.1599915772676468, 0.16090744733810425, 0.16159172356128693,
                0.16234374046325684, 0.16284653544425964, 0.16346895694732666, 0.16393250226974487,
                0.16450999677181244, 0.16476203501224518, 0.16513954102993011, 0.16534486413002014,
                0.16574470698833466, 0.1660114824771881, 0.16632576286792755, 0.1664169877767563,
                0.16643060743808746, 0.1662294566631317, 0.16586488485336304, 0.1649368852376938,
                0.1645088642835617, 0.16371634602546692, 0.1630546897649765, 0.16154807806015015,
                0.1600814014673233, 0.15826797485351562, 0.15608979761600494, 0.15369167923927307,
                0.1511661261320114, 0.14827698469161987, 0.14536917209625244, 0.142444908618927,
                0.1557874232530594, 0.13524435460567474, 0.1307692527770996, 0.1277199238538742)
        std = (0.25733536, 0.7051073, 0.32068878, 1.1206155, 0.26832762, 0.30502564, 0.23820099, 0.3468461,
               1.0768355, 1.3225003, 0.4323877, 0.40734583, 0.2646051, 0.22942708, 0.27049178, 0.22519968,
               0.22497371, 0.2250201, 0.22534208, 0.22586769, 0.2266848, 0.2277435, 0.2289841, 0.23036715,
               0.23187831, 0.23343562, 0.23514773, 0.23689654, 0.23876567, 0.24056244, 0.24247037, 0.24436007,
               0.24623597, 0.2481235, 0.25003663, 0.25180152, 0.25343093, 0.2550452, 0.25649136, 0.25783256,
               0.25901735, 0.2599637, 0.26083386, 0.26157066, 0.26191932, 0.2621681, 0.26220557, 0.26207653,
               0.26173836, 0.2612314, 0.26053765, 0.25968075, 0.25868613, 0.25754118, 0.25621477, 0.2547651,
               0.25317755, 0.25129953, 0.24920823, 0.2468689, 0.24426982, 0.24143067, 0.23827448, 0.23472059,
               0.23068619, 0.2260375, 0.22078814, 0.215031, 0.20930044, 0.20391387, 0.19926526, 0.19538623,
               0.19250241, 0.19040233, 0.18885842, 0.1876989, 0.18685184, 0.18617973, 0.1856935, 0.18520561,
               0.18479773, 0.18434358, 0.18393347, 0.18356149, 0.18331781, 0.18321085, 0.18326849, 0.18337184,
               0.18363117, 0.18390642, 0.18426958, 0.18471073, 0.1852175, 0.18578391, 0.18636838, 0.1869096,
               0.18746132, 0.18795143, 0.18841228, 0.18880914, 0.18920018, 0.18955049, 0.18982162, 0.18997067,
               0.19016132, 0.1901677, 0.19009112, 0.1899346, 0.18963341, 0.18920031, 0.18867949, 0.18791975,
               0.18709248, 0.18606584, 0.18486108, 0.18344449, 0.18191585, 0.1800925, 0.1782015, 0.17612904,
               0.17383197, 0.17139639, 0.16883221, 0.16610833, 0.16337971, 0.16060951, 0.15785442, 0.15511283,
               0.15243493, 0.14988288, 0.1474498, 0.14507842, 0.14288382, 0.14073686, 0.138604, 0.1363831,
               0.13397966, 0.1312616, 0.1282034, 0.12478443, 0.12106017, 0.11704976, 0.11267475, 0.10780761,
               0.10278689, 0.09791582, 0.0935083, 0.08940312, 0.08588858, 0.08296502, 0.08055043, 0.07863964,
               0.07709709, 0.07579459, 0.07475055, 0.07391801, 0.073239, 0.07266272, 0.07218111, 0.07181346,
               0.07158026, 0.07132407, 0.0711707, 0.07113521, 0.07109496, 0.07106862, 0.07111621, 0.07118069,
               0.07134509, 0.07151295, 0.07182348, 0.07214891, 0.07255574, 0.07301649, 0.07351442, 0.07405931,
               0.07461775, 0.07515452, 0.07579268, 0.07645085, 0.07714032, 0.07785247, 0.07859575, 0.07925811,
               0.08004165, 0.0807716, 0.08156711, 0.08231259, 0.08311074, 0.08388123, 0.08469653, 0.0854663,
               0.0863173, 0.08700226, 0.08776187, 0.08854887, 0.08933183, 0.09013577, 0.09090358, 0.09156618,
               0.09237044, 0.0930635, 0.09382042, 0.09449296, 0.0952006, 0.09583142, 0.09649963, 0.0971292,
               0.09782349, 0.09842034, 0.09913459, 0.0997033, 0.10034627, 0.10087726, 0.10143786, 0.10195142,
               0.10248962, 0.1029707, 0.10348839, 0.10396001, 0.1044193, 0.10470458, 0.10503376, 0.1053434,
               0.1056041, 0.10577423, 0.10598827, 0.10613247, 0.10637016, 0.10650609, 0.10669192, 0.10679198,
               0.10682209, 0.10677908, 0.10659397, 0.10616791, 0.10597543, 0.1055592, 0.10539887, 0.1047722,
               0.10411818, 0.10322235, 0.10222203, 0.10113382, 0.09984302, 0.09866208, 0.09760508, 0.09634618,
               0.39878017, 0.09598767, 0.09993725, 0.10360683)
    else:
        raise Exception('Camera type {} unknown for the fruit dataset.'.format(camera_type.value))

    mean, std = torch.tensor(mean), torch.tensor(std)

    return mean, std

def load_properties_hrss(camera_type: CameraType):
    if camera_type == CameraType.AVIRIS:  # indian pines
        dark_ref = (2560, 2709, 3649, 2810, 3840, 4056, 4004, 3865, 3775, 2792, 2700, 2594,
                    2560, 2600, 2665, 2614, 2560, 2560, 2560, 2560, 2560, 2560, 2521, 2452,
                    2398, 2289, 2211, 2178, 2139, 2054, 2272, 2013, 2165, 2364, 2359, 2400,
                    2588, 2723, 2675, 2127, 2672, 2878, 2723, 2676, 2576, 2461, 2568, 2674,
                    2597, 2572, 2590, 2560, 2484, 2157, 2084, 2038, 1898, 1419, 1458, 1540,
                    1715, 1860, 2004, 2044, 2019, 2032, 2028, 2017, 2018, 2010, 1949, 1949,
                    1892, 1865, 1700, 1542, 1222, 1177, 1248, 1202, 1329, 1430, 1507, 1474,
                    1496, 1464, 1445, 1478, 1472, 1479, 1451, 1392, 1407, 1423, 1346, 1386,
                    1380, 1344, 1305, 1254, 1169, 1107, 1029,
                    1001, 1008, 1017, 1022, 1034, 1034, 1043, 1051, 1095, 1103, 1130, 1147,
                    1162, 1162, 1157, 1173, 1148, 1152, 1165, 1151, 1160, 1168, 1162, 1157,
                    1147, 1155, 1151, 1147, 1129, 1134, 1122, 1120, 1111, 1088, 1092, 1089,
                    1072, 955, 1036, 1024, 1002,
                    987, 989, 997, 1003, 1016,
                    1008, 995, 1000, 1011, 1026, 1021, 1015, 1017, 1021, 1028, 1024, 1026,
                    1024, 1029, 1027, 1019, 1023, 1024, 1023, 1032, 1022, 1018, 1027, 1028,
                    1020, 1021, 1027, 1022, 1015, 1015, 1017, 1013, 1009, 1015, 1018, 1002,
                    1008, 1009, 1006, 1001, 1001, 998, 998, 999, 999, 993, 990, 992,
                    989, 986, 981)
        white_ref = (4536, 5744, 6361, 6362, 7153, 7980, 8284, 8128, 8194, 7928, 7990, 7918,
                     7700, 7960, 7948, 7924, 7698, 7522, 7415, 7307, 7271, 7311, 7229, 7084,
                     7081, 7000, 6786, 6963, 6903, 6317, 6366, 6722, 6897, 7182, 6941, 6729,
                     7591, 8611, 9604, 6119, 9219, 9360, 8963, 8817, 8232, 7417, 7874, 8576,
                     8359, 8451, 8275, 8355, 8153, 6590, 6256, 6065, 5355, 2969, 3160, 3327,
                     4613, 5425, 6155, 6619, 6488, 6543, 6499, 6517, 6472, 6445, 6255, 6107,
                     5948, 5672, 4941, 3920, 2182, 1936, 2377, 2319, 3204, 4206, 4469, 4471,
                     4660, 4651, 4856, 5002, 5198, 5190, 4967, 4444, 4620, 4894, 4296, 4580,
                     4563, 4184, 3663, 3269, 2511, 2003, 1147,
                     1072, 1117, 1159, 1217, 1412, 1588, 1435, 1619, 2039, 2430, 2694, 2882,
                     2973, 3028, 3055, 3015, 2844, 2880, 2940, 2874, 2872, 2962, 2970, 2881,
                     2878, 2880, 2835, 2816, 2772, 2727, 2656, 2620, 2521, 2425, 2385, 2302,
                     2106, 1839, 1603, 1286, 1089,
                     1072, 1087, 1256, 1506, 1677,
                     1545, 1215, 1232, 1496, 1746, 1709, 1535, 1536, 1641, 1767, 1806, 1816,
                     1806, 1799, 1784, 1761, 1724, 1710, 1690, 1680, 1662, 1651, 1689, 1691,
                     1653, 1648, 1601, 1586, 1577, 1565, 1542, 1550, 1546, 1510, 1526, 1458,
                     1431, 1449, 1377, 1347, 1363, 1364, 1287, 1289, 1315, 1258, 1201, 1245,
                     1167, 1076, 1036)
    elif camera_type == CameraType.AVIRIS_2:  # salinas
        dark_ref = (87, 86, 90, 86, 91, 91, 88, 88, 87, 86, 84, 83, 79, 78,
                    78, 70, 67, 64, 66, 59, 53, 46, 35, 20, 10, 5, 1, 0,
                    -2, 2, 1, 1, 2, 4, 0, 2, 1, 4, 10, 14, 20, 37,
                    46, 48, 29, 23, 32, 50, 52, 41, 41, 43, 50, 48, 47, 52,
                    53, 53, 54, 52, 47, 46, 45, 44, 42, 43, 43, 40, 37, 37,
                    35, 30, 31, 25, 26, 26, 15, 23, 23, 19, 19, 16, 13, 12,
                    15, 14, 8, 11, 9, 6, 9, 3, 1, 1, 3, -2, 74, 63,
                    68, 76, 74, 65, 55, 45, 32, 16, -3,
                    -3, 0, 1, 2, 7, 7, 8, 10, 18, 22, 29, 28, 29, 32,
                    31, 31, 27, 28, 29, 29, 27, 30, 27, 26, 26, 26, 25, 24,
                    21, 20, 22, 18, 18, 15, 14, 13, 12, 9, 4, -1, -3,
                    -3,
                    -2, 2, 6, 6, 0, -2, 0, 8, 10, 5, 6, 6, 9, 7,
                    9, 12, 9, 10, 12, 10, 10, 10, 6, 9, 9, 6, 7, 8,
                    7, 7, 5, 5, 5, 4, 4, 3, -5, 2, 0, 0, 1, -2,
                    0, -2, -3, -3, -6, -2, -7, -5, -3, -6, -9, -8, -11)
        white_ref = (814, 1165, 1920, 3865, 5153, 5614, 5663, 6599, 7748, 8209, 8387, 8668,
                     8455, 8757, 8849, 8543, 8934, 9141, 9207, 9171, 9089, 9097, 9020, 8956,
                     9049, 8845, 8698, 8697, 8599, 8336, 8643, 8534, 8694, 8613, 7988, 7611,
                     7875, 7652, 6548, 6948, 7417, 8266, 5104, 7846, 8534, 8240, 8063, 7735,
                     6512, 6783, 7302, 7330, 7133, 7009, 7005, 6833, 5732, 5153, 4778, 4840,
                     2242, 2283, 2516, 3265, 4367, 4783, 5248, 5201, 5182, 5159, 5094, 5010,
                     4910, 4765, 4607, 4541, 4359, 3917, 3346, 1714, 1022, 1405, 1439, 2003,
                     2993, 3325, 3243, 3439, 3290, 3416, 3544, 3645, 3623, 3501, 3070, 2868,
                     3300, 2816, 3042, 3221, 3155, 2839, 2479, 2093, 1949, 2033, 2040,
                     2149, 2218, 2279, 2321, 2299, 2318, 2321, 2314,
                     2340, 2311, 2287, 2299, 2301, 2286, 2356, 2340, 2330, 2361, 2205, 2149,
                     2224, 2206, 2445, 2890, 3273, 3390, 2069, 3156, 3446, 3392, 3363, 3276,
                     2772, 2799, 2880, 2858, 2727, 2653, 2642, 2540, 2115,
                     1731,
                     1701, 1652, 1596, 1586, 1517, 1366, 1156, 1394, 1561, 1167, 1019, 1137,
                     1464, 1585, 1623, 1626, 1603, 1637, 1626, 1546, 1478, 1455, 1431, 1425,
                     1344, 1401, 1402, 1370, 1318, 1261, 1189, 1166, 1132, 1088, 1035, 1084,
                     942, 1003, 881, 785, 858, 702, 671, 667, 709, 569, 504, 608,
                     523, 596, 693, 745, 765, 777, 775)
    elif camera_type == CameraType.ROSIS:  # pavia university
        dark_ref = (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 16, 16, 26,
                    37, 41, 59, 71, 72, 66, 66, 0, 0, 0, 0, 0, 106, 147,
                    140, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 145, 146,
                    150, 140, 0, 134, 0)
        white_ref = (8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000,
                     8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000,
                     8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000,
                     8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000,
                     8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000,
                     8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000,
                     8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000,
                     8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000,
                     8000, 8000, 8000, 8000, 8000, 8000, 8000)
    else:
        raise Exception('Camera type {} unknown for this remote sensing dataset.'.format(camera_type.value))

    dark_ref, white_ref = torch.tensor(dark_ref), torch.tensor(white_ref)

    return dark_ref, (white_ref - dark_ref)

def load_properties_waste(camera_type: CameraType):
    print("!!!! Calculate normalization parameters !!!!")
    # FIXME not final
    if camera_type == CameraType.SPECIM_FX17:
        mean = (0.1078, 0.1083, 0.1054, 0.1037, 0.1015, 0.0997, 0.0973, 0.0952, 0.0940,
                0.0932, 0.0929, 0.0928, 0.0906, 0.0905, 0.0911, 0.0915, 0.0912, 0.0916,
                0.0918, 0.0924, 0.0931, 0.0942, 0.0938, 0.0931, 0.0929, 0.0934, 0.0930,
                0.0930, 0.0928, 0.0932, 0.0931, 0.0933, 0.0936, 0.0940, 0.0945, 0.0949,
                0.0955, 0.0958, 0.0964, 0.0966, 0.0974, 0.0979, 0.0985, 0.0992, 0.0997,
                0.1002, 0.1008, 0.1014, 0.1017, 0.1025, 0.1033, 0.1041, 0.1047, 0.1055,
                0.1064, 0.1071, 0.1079, 0.1086, 0.1098, 0.1106, 0.1115, 0.1122, 0.1134,
                0.1145, 0.1156, 0.1165, 0.1175, 0.1188, 0.1201, 0.1214, 0.1223, 0.1233,
                0.1244, 0.1255, 0.1264, 0.1270, 0.1279, 0.1288, 0.1297, 0.1305, 0.1309,
                0.1312, 0.1317, 0.1321, 0.1326, 0.1329, 0.1331, 0.1336, 0.1340, 0.1343,
                0.1343, 0.1344, 0.1346, 0.1351, 0.1355, 0.1358, 0.1359, 0.1359, 0.1363,
                0.1371, 0.1378, 0.1385, 0.1388, 0.1387, 0.1386, 0.1390, 0.1395, 0.1403,
                0.1409, 0.1412, 0.1414, 0.1417, 0.1421, 0.1427, 0.1434, 0.1440, 0.1445,
                0.1449, 0.1452, 0.1455, 0.1458, 0.1461, 0.1464, 0.1467, 0.1470, 0.1473,
                0.1477, 0.1481, 0.1483, 0.1484, 0.1484, 0.1483, 0.1485, 0.1488, 0.1493,
                0.1497, 0.1501, 0.1504, 0.1506, 0.1505, 0.1504, 0.1502, 0.1502, 0.1504,
                0.1505, 0.1508, 0.1511, 0.1512, 0.1512, 0.1509, 0.1507, 0.1503, 0.1504,
                0.1505, 0.1507, 0.1509, 0.1510, 0.1509, 0.1510, 0.1510, 0.1508, 0.1505,
                0.1504, 0.1503, 0.1502, 0.1501, 0.1501, 0.1501, 0.1501, 0.1501, 0.1501,
                0.1501, 0.1500, 0.1499, 0.1497, 0.1495, 0.1493, 0.1492, 0.1489, 0.1491,
                0.1490, 0.1492, 0.1491, 0.1492, 0.1491, 0.1492, 0.1492, 0.1493, 0.1492,
                0.1492, 0.1492, 0.1494, 0.1494, 0.1493, 0.1497, 0.1498, 0.1498, 0.1501,
                0.1500, 0.1503, 0.1506, 0.1512, 0.1510, 0.1509, 0.1511, 0.1512, 0.1515,
                0.1521, 0.1524, 0.1525, 0.1529, 0.1531, 0.1537, 0.1540, 0.1541, 0.1546,
                0.1550, 0.1546, 0.1547, 0.1549, 0.1550, 0.1557, 0.1556, 0.1564)
        std = (0.0951, 0.0942, 0.0917, 0.0894, 0.0868, 0.0845, 0.0826, 0.0811, 0.0801,
               0.0797, 0.0796, 0.0799, 0.0793, 0.0795, 0.0802, 0.0808, 0.0812, 0.0817,
               0.0823, 0.0831, 0.0836, 0.0844, 0.0847, 0.0845, 0.0845, 0.0850, 0.0850,
               0.0851, 0.0853, 0.0857, 0.0858, 0.0861, 0.0864, 0.0866, 0.0870, 0.0875,
               0.0879, 0.0880, 0.0887, 0.0891, 0.0894, 0.0897, 0.0904, 0.0910, 0.0913,
               0.0916, 0.0923, 0.0929, 0.0931, 0.0936, 0.0943, 0.0950, 0.0953, 0.0958,
               0.0965, 0.0970, 0.0974, 0.0978, 0.0987, 0.0992, 0.0995, 0.0998, 0.1006,
               0.1015, 0.1020, 0.1023, 0.1027, 0.1035, 0.1045, 0.1051, 0.1055, 0.1060,
               0.1069, 0.1077, 0.1082, 0.1085, 0.1089, 0.1096, 0.1103, 0.1108, 0.1110,
               0.1112, 0.1116, 0.1120, 0.1122, 0.1124, 0.1126, 0.1129, 0.1133, 0.1134,
               0.1134, 0.1133, 0.1134, 0.1138, 0.1142, 0.1144, 0.1144, 0.1142, 0.1144,
               0.1149, 0.1155, 0.1161, 0.1163, 0.1162, 0.1160, 0.1161, 0.1164, 0.1170,
               0.1175, 0.1177, 0.1177, 0.1177, 0.1179, 0.1183, 0.1187, 0.1192, 0.1194,
               0.1196, 0.1197, 0.1199, 0.1201, 0.1202, 0.1204, 0.1206, 0.1207, 0.1209,
               0.1211, 0.1213, 0.1215, 0.1214, 0.1213, 0.1211, 0.1212, 0.1214, 0.1217,
               0.1220, 0.1223, 0.1226, 0.1227, 0.1226, 0.1225, 0.1223, 0.1222, 0.1223,
               0.1224, 0.1226, 0.1228, 0.1229, 0.1229, 0.1226, 0.1224, 0.1221, 0.1221,
               0.1222, 0.1223, 0.1225, 0.1225, 0.1225, 0.1225, 0.1224, 0.1223, 0.1220,
               0.1219, 0.1218, 0.1217, 0.1217, 0.1216, 0.1216, 0.1216, 0.1216, 0.1215,
               0.1214, 0.1213, 0.1212, 0.1210, 0.1209, 0.1207, 0.1206, 0.1204, 0.1204,
               0.1204, 0.1204, 0.1204, 0.1205, 0.1204, 0.1205, 0.1204, 0.1205, 0.1204,
               0.1203, 0.1203, 0.1204, 0.1204, 0.1204, 0.1206, 0.1207, 0.1207, 0.1209,
               0.1209, 0.1210, 0.1211, 0.1214, 0.1212, 0.1210, 0.1211, 0.1213, 0.1215,
               0.1217, 0.1219, 0.1221, 0.1223, 0.1225, 0.1228, 0.1230, 0.1231, 0.1234,
               0.1237, 0.1235, 0.1236, 0.1237, 0.1238, 0.1241, 0.1241, 0.1246)
    else:
        raise Exception('Camera type {} unknown for the debris dataset.'.format(camera_type.value))

    mean, std = torch.tensor(mean), torch.tensor(std)

    return mean, std

def bands_as_first_dimension(_obj):
    if isinstance(_obj, torch.Tensor):
        return _obj.permute(2, 0, 1)
    else:
        return _obj.transpose((2, 0, 1))


def bands_as_first_dimension_rev(_obj):
    if isinstance(_obj, torch.Tensor):
        return _obj.permute(1, 2, 0)
    else:
        return _obj.transpose((1, 2, 0))
